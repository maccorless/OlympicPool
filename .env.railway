# Railway Environment Variables Template
# Copy these variables to Railway Dashboard → Variables tab
# Or use: railway variables set KEY=value

# ============================================================================
# CORE CONFIGURATION (Required)
# ============================================================================

# Flask Secret Key (CRITICAL - Generate with command below)
# python3 -c "import secrets; print(secrets.token_urlsafe(32))"
FLASK_SECRET_KEY=<GENERATE-STRONG-32-CHAR-SECRET>

# Debug Mode (MUST be False in production)
FLASK_DEBUG=False

# Base URL (Set after getting Railway URL)
# Initially: https://<your-project>.up.railway.app
# Later: https://medalpool.com (after custom domain setup)
BASE_URL=https://<your-project>.up.railway.app

# ============================================================================
# SESSION SECURITY (Required for HTTPS)
# ============================================================================

# MUST be True in production with HTTPS
SESSION_COOKIE_SECURE=True

# ============================================================================
# ADMIN ACCESS (Required)
# ============================================================================

# Contest-level admins (can manage specific contests)
# Comma-separated email addresses
ADMIN_EMAILS=your@email.com,other@email.com

# Global admins (can create/manage events and contests)
# Falls back to ADMIN_EMAILS if not set
GLOBAL_ADMIN_EMAILS=your@email.com

# ============================================================================
# SMS AUTHENTICATION - Twilio (Required for Production)
# ============================================================================

# Twilio Account SID (from Twilio Console)
TWILIO_ACCOUNT_SID=ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# Twilio Auth Token (from Twilio Console)
TWILIO_AUTH_TOKEN=your_auth_token_here

# Twilio Verify Service SID (from Twilio Verify Console)
TWILIO_VERIFY_SERVICE_SID=VAxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# Show OTP on page instead of sending SMS (for testing)
# Set to False for production
NO_SMS_MODE=False

# ============================================================================
# EMAIL SERVICE - Resend (Optional)
# ============================================================================

# Resend API Key (from Resend Dashboard)
# Leave empty if not using email
RESEND_API_KEY=re_xxxxxxxxxxxxxxxxxxxx

# Disable email sending (print to console instead)
# Set to False if using Resend
NO_EMAIL_MODE=True

# ============================================================================
# DATABASE (Optional - has smart defaults)
# ============================================================================

# Database directory (defaults to instance/)
# On Railway, should match volume mount path
# Only set if you need to override default
# DATABASE_DIR=/app/instance

# ============================================================================
# RAILWAY-SPECIFIC (Set automatically by Railway)
# ============================================================================

# These variables are automatically set by Railway - DO NOT set manually:
# PORT=<set-by-railway>
# RAILWAY_ENVIRONMENT=production
# RAILWAY_PROJECT_ID=<project-id>
# RAILWAY_SERVICE_ID=<service-id>

# ============================================================================
# DEPLOYMENT NOTES
# ============================================================================

# 1. Generate Strong Secret Key:
#    python3 -c "import secrets; print(secrets.token_urlsafe(32))"
#
# 2. Get Twilio Credentials:
#    - Sign up at https://www.twilio.com
#    - Create Verify Service at https://console.twilio.com/verify
#    - Copy Account SID, Auth Token, and Verify Service SID
#
# 3. Set Variables via Railway CLI:
#    railway variables set FLASK_SECRET_KEY="your-secret-key"
#    railway variables set FLASK_DEBUG=False
#    railway variables set BASE_URL="https://your-url.railway.app"
#    railway variables set ADMIN_EMAILS="your@email.com"
#    railway variables set GLOBAL_ADMIN_EMAILS="your@email.com"
#    railway variables set SESSION_COOKIE_SECURE=True
#    railway variables set TWILIO_ACCOUNT_SID="ACxxxxx"
#    railway variables set TWILIO_AUTH_TOKEN="your-token"
#    railway variables set TWILIO_VERIFY_SERVICE_SID="VAxxxxx"
#    railway variables set NO_SMS_MODE=False
#    railway variables set NO_EMAIL_MODE=True
#
# 4. Or Set via Railway Dashboard:
#    - Go to https://railway.app/dashboard
#    - Select your project
#    - Click "Variables" tab
#    - Add each variable from this template
#
# 5. After Custom Domain Setup:
#    railway variables set BASE_URL="https://medalpool.com"
#
# 6. Verify Variables:
#    railway variables
#
# 7. Deploy:
#    railway up
#
# 8. Monitor:
#    railway logs --follow

# ============================================================================
# TESTING CONFIGURATION (Development/Staging)
# ============================================================================

# For testing without SMS:
# NO_SMS_MODE=True

# For testing without SSL locally:
# SESSION_COOKIE_SECURE=False

# For local development:
# FLASK_DEBUG=True
# BASE_URL=http://localhost:5000

# ============================================================================
# SECURITY CHECKLIST
# ============================================================================

# Before going live:
# [ ] FLASK_SECRET_KEY is strong (32+ characters)
# [ ] FLASK_DEBUG=False
# [ ] SESSION_COOKIE_SECURE=True
# [ ] BASE_URL uses https://
# [ ] ADMIN_EMAILS configured
# [ ] TWILIO credentials are valid
# [ ] NO_SMS_MODE=False (for production)
# [ ] No secrets committed to git
# [ ] Volume mounted at /app/instance
# [ ] Database persists across deployments

# ============================================================================
# TROUBLESHOOTING
# ============================================================================

# Database not persisting?
# → Verify volume: railway volume list
# → Volume should be mounted at /app/instance

# SMS not sending?
# → Check Twilio credentials: railway variables | grep TWILIO
# → Verify NO_SMS_MODE=False
# → Check Twilio dashboard for errors

# SSL certificate error?
# → Verify SESSION_COOKIE_SECURE=True
# → Check domain DNS: dig medalpool.com
# → Wait 10-15 minutes for Let's Encrypt

# App not starting?
# → Check logs: railway logs --follow
# → Verify environment variables: railway variables
# → Check service status: railway status

# Environment variables not loading?
# → Restart service: railway restart
# → Verify variables are set: railway variables
# → Check logs for .env messages

# ============================================================================
# QUICK REFERENCE
# ============================================================================

# Set all variables at once (after filling in values):
# railway variables set \
#   FLASK_SECRET_KEY="<your-secret>" \
#   FLASK_DEBUG=False \
#   BASE_URL="<your-url>" \
#   SESSION_COOKIE_SECURE=True \
#   ADMIN_EMAILS="<your-email>" \
#   GLOBAL_ADMIN_EMAILS="<your-email>" \
#   TWILIO_ACCOUNT_SID="<your-sid>" \
#   TWILIO_AUTH_TOKEN="<your-token>" \
#   TWILIO_VERIFY_SERVICE_SID="<your-service-sid>" \
#   NO_SMS_MODE=False \
#   NO_EMAIL_MODE=True
